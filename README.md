# Synergy'25 Deepfake Hackathon

This repository contains the official submission for the **Synergy'25 Deepfake ML Model Hackathon**. The challenge was to develop a model that could accurately replicate the outputs of a proprietary deepfake detection system based on a provided training set of images and JSON predictions.

Our final solution is a high-accuracy, **weighted ensemble of two powerful, pre-trained CNNs: `EfficientNetV2B2` and `ResNet101V2`**.

## üöÄ The Solution

Our approach combines the feature-extraction strengths of two different, state-of-the-art architectures. Instead of relying on a single model, we use transfer learning on both and then combine their predictions.

* **Models:** `EfficientNetV2B2` and `ResNet101V2` pre-trained on ImageNet.
* **Strategy:** A two-phase training process (head-training followed by full fine-tuning with a low learning rate) was used for both models.
* **Key Insight:** A simple 50/50 average of the models gave 90.00% validation accuracy. [cite_start]By running an optimization experiment, we found a "champion" model: a weighted average of **43% `EfficientNetV2B2`** and **57% `ResNet101V2`**, which boosted our accuracy to **90.33%**. [cite: 80, 81, 82]

## üö® Model Weights (.keras files)

Due to their large size, the trained model weights (`best_effnet_model.keras` and `best_resnet_model.keras`) are not stored in this GitHub repository.

You can download them from the following Google Drive link:

[**Download Model Weights Here**](https://drive.google.com/drive/folders/1X17C94IxBA77B3XAWJi7BXVbQlcPcEjy?usp=sharing)

## üìÅ Repository Contents

* `Synergy.ipynb`: The main Google Colab notebook containing all code for data preprocessing, pipeline creation, model training, ensemble optimization, and final submission generation.
* [cite_start]`Team-404.docx`: The detailed technical documentation and project report. [cite: 1]
* `Deepfake ML Hackathon Rulebook.pdf`: The original hackathon rules and problem statement.
* `submission_optimized.json`: The final submission file generated by the notebook, using the optimized 43/57 ensemble.

## ‚öôÔ∏è How to Run

1.  **Download Data:** This repository does not include the dataset. You must have the `fake_cifake_images/`, `real_cifake_images/`, `test/`, `fake_cifake_preds.json`, and `real_cifake_preds.json` files from the hackathon.
2.  **Download Model Weights:** Download the `.keras` files from the Google Drive link above.
3.  **Setup Environment:** Open `Synergy.ipynb` in Google Colab (recommended) or a local Jupyter environment.
4.  **Update Paths:**
    * In Cell 1, update `BASE_PATH` to point to your dataset location (e.g., `/content/drive/MyDrive/Deepfake/`).
    * Upload the downloaded `.keras` files to your Colab/Jupyter runtime directory.
5.  **Run Notebook:** Run the cells sequentially. The notebook will load data, build models, run the final evaluation, and generate the `submission_optimized.json` file.

## üõ†Ô∏è Key Dependencies

The solution was built using the following major libraries:

* `tensorflow` (tf.keras)
* `pandas`
* `numpy`
* `scikit-learn` (for `train_test_split` and `accuracy_score`)
* `matplotlib` / `seaborn`
